小米路由智能VPN分流配置
===

通过VPN上网是大家都懂的。如果通过VPN访问大陆的网站将会变得很慢，小米路由的智能VPN分流可以按服务地址来选择哪些流量是从VPN出去的，其余的就按正常方式访问。要做到全家智能上网，你需要的是一个VPN账号，还有就是一个需要分流到VPN的地址（域名）清单了。

## 使用方法

proxy.txt 包含了一些需要分流的常用地址。你可以根据自己的需要添加一些自己需要的域名。

### 批量倒入

开启小米路由的开发者模式，通过ssh访问小米路由。开启方法在小米官方有教程。把proxy.txt文件放在路由器的 /etc/smartvpn目录下，然后在路由器Web管理界面的“高级设置/VPN”中就可以看到这个清单了。重新启动VPN就可以用了。

### 手工录入

不懂的ssh操作的朋友，可以小米路由的VPN界面可以把 proxy.txt 中的域名和ip一个一个地录入进去。域名最前面的"."不需要录入，地址就按原来的样子录入就可以了。由于域名很多，手工输入还是很费劲的，希望网友能够总结出一个能够平顺访问海外主流网站的最小域名清单出来。

由于清单中有1000多个个网址，全部手工输入其实是不现实的，可以挑选一些自己经常会访问的网站输入进去。以后发现哪个网站访问不了，再加上去就是了。由于网站有很多图片和视频都是放到不同的域名之下的，要让一个网站能够平顺访问，可能需要添加好几个域名。希望有热心的git友能够整理出一个20网址的精简版，能够让几个主流的海外网站正常访问，以便让不懂技术的普通人能够很快地手工输入。

---
如果有有些常用的主流网站没有包括进去，欢迎git友帮忙添加，造福人类。
清单中有很多不常用的网址，有些甚至已经关闭的，欢迎git友对清单进行精简。

### 小米路由器4
在小米路由器4中，目前还没开发版本，不能进行ssh，不过我们可以直接进行VPN拨号，导入翻墙列表同样达到效果。
安装PPTP VPN(https://linux.cn/article-3376-1.html)，然后可以进行拨号。

### 批量添加proxy.txt脚本
先修改stok值，登录路由器后链接上面有，替换一下脚本中的stok值，在shell中运行一下脚本就可以自动导入了。
```
    sh script.sh
```
